{template '_header'}
{if $_W[method] == 'plist'}
<div class="page-heading"> 
    <span class='pull-right'>
        {ifp 'shop.adv.add'}
        	<a class='btn btn-primary btn-sm' href="{php echo webUrl('shop/adv/pedit')}"><i class='fa fa-plus'></i> 添加位置</a>
        {/if}
    </span>
    <h2>幻灯片位置管理</h2> 
</div>
<form action="./index.php" method="get" class="form-horizontal form-search" role="form">
    <input type="hidden" name="c" value="site" />
    <input type="hidden" name="a" value="entry" />
    <input type="hidden" name="m" value="ewei_shopv2" />
    <input type="hidden" name="do" value="web" />
    <input type="hidden" name="r"  value="shop.adv.plist" />
    <div class="page-toolbar row m-b-sm m-t-sm">
              <div class="col-sm-6 pull-right">
	
            <div class="input-group">				 
                <input type="text" class="input-sm form-control" name='keyword' value="{$_GPC['keyword']}" placeholder="请输入关键词"> 
                <span class="input-group-btn">
                	<button class="btn btn-sm btn-primary" type="submit"> 搜索</button> 
                </span>
            </div>
        </div>
        
    </div>
</form>

<form action="" method="post">
    {if count($list)>0}
    <table class="table table-responsive table-hover" >
         <tr>
            <th style="width:50px;">ID</th>		
            <th>位置名称</th>
            <th>尺寸</th>
            <th>描述</th>
            <th>包含幻灯片数量</th>
            <th>状态</th>
            <th>操作</th>
        </tr>
        <tbody>
                {loop $list $row}
                <tr>
                    <td>{$row['pid']}</td>
                    <td>{if $row['is_system']}<span class='label label-danger'>系统</span>{/if}{$row['position_name']}</td>
                    <td>{$row['size']}</td>
                    <td>{$row['desc']}</td>
                    <td>{ifp 'shop.adv.view'}<a href="{php echo webUrl('shop/adv', array('position_id' => $row['pid']))}" class="btn btn-default btn-sm" title="查看幻灯片">查看幻灯片({$row['counts']})</a>{/if}</td>
                    <td>
                                    {if $row['enabled']==1}
                                    <span class='label label-success'>显示</span>
                                    {else}
                                    <span class='label label-danger'>隐藏</span>
                                    {/if}
                    </td>
                    <td style="text-align:left;">
                        {ifp 'shop.adv.view|shop.adv.edit'}
                        &nbsp; 
                        <a href="{php echo webUrl('shop/adv/pedit', array('id' => $row['pid']))}" class="btn btn-default btn-sm" title="{ifp 'shop.adv.edit'}修改{else}查看{/if}"><i class="fa fa-edit"></i></a>{/if}
                        {if !$row['is_system']}{ifp 'shop.adv.delete'}<a data-toggle='ajaxRemove' href="{php echo webUrl('shop/adv/pdelete', array('id' => $row['pid']))}" class="btn btn-default btn-sm" data-confirm='确认删除此位置吗，连同包括的幻灯片也会一起删除?'><i class="fa fa-times"></i></a>{/if}{/if}
                    </td>
                </tr>
                {/loop} 
                <tr>
                    <td colspan='7'>
                        {ifp 'shop.adv.add'}
                          <a class='btn btn-primary' href="{php echo webUrl('shop/adv/pedit')}"><i class='fa fa-plus'></i> 添加位置</a>
                       {/if}
                    </td>
                </tr>
            </tbody>
        </table>
        {else}
        <div class='panel panel-default'>
            <div class='panel-body' style='text-align: center;padding:30px;'>
                暂时没有任何幻灯片位置!
            </div>
        </div>
        {/if}
    </form>

{elseif $_W['method'] == 'pedit'}
<div class="page-heading"> 
	<span class='pull-right'>
		{ifp 'shop.adv.add'}
			<a class="btn btn-primary btn-sm" href="{php echo webUrl('shop/adv/pedit')}">添加新位置</a>
		{/if}
		<a class="btn btn-default  btn-sm" href="{php echo webUrl('shop/adv/plist')}">返回列表</a>
	</span>
	<h2>{if !empty($item['pid'])}编辑{else}添加{/if}位置 <small>{if !empty($item['pid'])}修改【{$item['position_name']}】{/if}</small></h2> 
</div>
 
    <form {ife 'shop.adv' $item}action="" method="post"{/if} class="form-horizontal form-validate" enctype="multipart/form-data">
        <input type="hidden" name="id" value="{$item['pid']}" />
                <div class="form-group">
                    <label class="col-sm-2 control-label must">位置名称</label>
                    <div class="col-sm-9 col-xs-12 ">
                         {ife 'shop.adv' $item}
                        	<input type="text" id='position_name' name="position_name" class="form-control" value="{$item['position_name']}" data-rule-required="true" />
                         {else}
                        	<div class='form-control-static'>{$item['position_name']}</div>
                        {/if}
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">尺寸</label>
                    <div class="col-sm-9 col-xs-12">
                    	{ife 'shop.adv' $item}
	                        <input type="text" id='size' name="size" class="form-control" value="{$item['size']}" />
                        {else}
                            <div class='form-control-static'>{$item['size']}</div>
                        {/if}
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">描述</label>
                    <div class="col-sm-9 col-xs-12">
                    	{ife 'shop.adv' $item}
                        <input type="text" id='desc' name="desc" class="form-control" value="{$item['desc']}" />
                         {else}
                        <div class='form-control-static'>{$item['desc']}</div>
                        {/if}
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">状态</label>
                    <div class="col-sm-9 col-xs-12">
                    	{ife 'shop.adv' $item}
                    		<label class='radio-inline'>
                            	<input type='radio' name='enabled' value=1' {if $item['enabled']==1}checked{/if} /> 显示
                            </label>
                        	<label class='radio-inline'>
                        		<input type='radio' name='enabled' value=0' {if $item['enabled']==0}checked{/if} /> 隐藏
                        	</label>
                        {else}
                            <div class='form-control-static'>{if empty($item['enabled'])}隐藏{else}显示{/if}</div>
                        {/if}
                    </div>
                </div>
            
            <div class="form-group">
                    <label class="col-sm-2 control-label"></label>
                    <div class="col-sm-9 col-xs-12">
                    	{ife 'shop.adv' $item}
                    		<input type="submit" value="提交" class="btn btn-primary"  />
                    	{/if}
                       <input type="button" name="back" onclick='history.back()' {ifp 'shop.adv.add|shop.adv.edit'}style='margin-left:10px;'{/if} value="返回列表" class="btn btn-default" />
                    </div>
            </div>
 
    </form>
 

<script language='javascript'>
    function formcheck() {
        if ($("#position_name").isEmpty()) {
            Tip.focus("position_name", "请填写位置名称!");
            return false;
        }
        return true;
    }
</script>
{/if}
{template '_footer'}