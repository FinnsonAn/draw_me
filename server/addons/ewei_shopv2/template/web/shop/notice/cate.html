{template '_header'}
{if $_W[method] == 'catelist'}
<div class="page-heading"> 
    <span class='pull-right'>
        {ifp 'shop.notice.add'}
        	<a class='btn btn-primary btn-sm' href="{php echo webUrl('shop/notice/cateedit')}"><i class='fa fa-plus'></i> 添加分类</a>
        {/if}
    </span>
    <h2>分类管理</h2> 
</div>
<form action="./index.php" method="get" class="form-horizontal form-search" role="form">
    <input type="hidden" name="c" value="site" />
    <input type="hidden" name="a" value="entry" />
    <input type="hidden" name="m" value="ewei_shopv2" />
    <input type="hidden" name="do" value="web" />
    <input type="hidden" name="r"  value="shop.notice.catelist" />
    <div class="page-toolbar row m-b-sm m-t-sm">
              <div class="col-sm-6 pull-right">
	
            <div class="input-group">				 
                <input type="text" class="input-sm form-control" name='keyword' value="{$_GPC['keyword']}" placeholder="请输入关键词"> 
                <span class="input-group-btn">
                	<button class="btn btn-sm btn-primary" type="submit"> 搜索</button> 
                </span>
            </div>
        </div>
        
    </div>
</form>

<form action="" method="post">
    {if count($list)>0}
    <table class="table table-responsive table-hover" >
         <tr>
            <th style="width:50px;">ID</th>
            <th>显示顺序</th>			
            <th>分类名称</th>
            <th>包含文章</th>
            <th>状态</th>
            <th>操作</th>
        </tr>
        <tbody>
                {loop $list $row}
                <tr>
                    <td>{$row['id']}</td>
                    <td>
                        {ifp 'shop.notice.edit'}
                           <input type="text" class="form-control" name="displayorder[{$row['id']}]" value="{$row['displayorder']}">
                        {else}
                           {$row['displayorder']}
                        {/if}
                    </td>
                    <td>{if $row['is_system']}<span class='label label-danger'>系统保护</span>{/if}{$row['title']}</td>
                    <td><a href="{php echo webUrl('shop/notice', array('cid' => $row['id']))}" class="btn btn-default btn-sm" title="查看文章">查看文章({$row['counts']})</a></td>
                    <td>
                                    {if $row['enabled']==1}
                                    <span class='label label-success'>显示</span>
                                    {else}
                                    <span class='label label-danger'>隐藏</span>
                                    {/if}
                    </td>
                    <td style="text-align:left;">
                        {ifp 'shop.notice.view|shop.notice.edit'}
                        &nbsp; 
                        <a href="{php echo webUrl('shop/notice/cateedit', array('id' => $row['id']))}" class="btn btn-default btn-sm" title="{ifp 'shop.notice.edit'}修改{else}查看{/if}"><i class="fa fa-edit"></i></a>{/if}
                        {if !$row['is_system']}{ifp 'shop.notice.delete'}<a data-toggle='ajaxRemove' href="{php echo webUrl('shop/notice/catedel', array('id' => $row['id']))}" class="btn btn-default btn-sm" data-confirm='确认删除此分类吗，连同包括的也会一起删除?'><i class="fa fa-times"></i></a>{/if}{/if}
                    </td>
                </tr>
                {/loop} 
                <tr>
                    <td colspan='6'>
                        {ifp 'shop.notice.add'}
                          <a class='btn btn-primary' href="{php echo webUrl('shop/notice/cateedit')}"><i class='fa fa-plus'></i> 添加分类</a>
                       {/if}
                    </td>
                </tr>
            </tbody>
        </table>
        {else}
        <div class='panel panel-default'>
            <div class='panel-body' style='text-align: center;padding:30px;'>
                暂时没有任何分类!
            </div>
        </div>
        {/if}
    </form>

{elseif $_W['method'] == 'cateedit'}
<div class="page-heading"> 
	<span class='pull-right'>
		{ifp 'shop.notice.add'}
			<a class="btn btn-primary btn-sm" href="{php echo webUrl('shop/notice/cateedit')}">添加分类</a>
		{/if}
		<a class="btn btn-default  btn-sm" href="{php echo webUrl('shop/notice/catelist')}">返回列表</a>
	</span>
	<h2>{if !empty($item['id'])}编辑{else}添加{/if}分类 <small>{if !empty($item['id'])}修改【{$item['title']}】{/if}</small></h2> 
</div>
 
    <form {ife 'shop.notice' $item}action="" method="post"{/if} class="form-horizontal form-validate" enctype="multipart/form-data">
        <input type="hidden" name="id" value="{$item['id']}" />
       			 <div class="form-group">
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label">排序</label>
                    <div class="col-sm-9 col-xs-12">
                        {ife 'shop.notice' $item}
                                <input type="text" name="displayorder" class="form-control" value="{$item['displayorder']}" />
                                <span class='help-block'>数字越大，排名越靠前</span>
                        {else}
                            <div class='form-control-static'>{$item['displayorder']}</div>
                        {/if}
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label must">分类名称</label>
                    <div class="col-sm-9 col-xs-12 ">
                         {ife 'shop.notice' $item}
                        	<input type="text" id='title' name="title" class="form-control" value="{$item['title']}" data-rule-required="true" />
                         {else}
                        	<div class='form-control-static'>{$item['title']}</div>
                        {/if}
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">状态</label>
                    <div class="col-sm-9 col-xs-12">
                    	{ife 'shop.notice' $item}
                    		<label class='radio-inline'>
                            	<input type='radio' name='enabled' value=1' {if $item['enabled']==1}checked{/if} /> 显示
                            </label>
                        	<label class='radio-inline'>
                        		<input type='radio' name='enabled' value=0' {if $item['enabled']==0}checked{/if} /> 隐藏
                        	</label>
                        {else}
                            <div class='form-control-static'>{if empty($item['enabled'])}隐藏{else}显示{/if}</div>
                        {/if}
                    </div>
                </div>
            
            <div class="form-group">
                    <label class="col-sm-2 control-label"></label>
                    <div class="col-sm-9 col-xs-12">
                    	{ife 'shop.notice' $item}
                    		<input type="submit" value="提交" class="btn btn-primary"  />
                    	{/if}
                       <input type="button" name="back" onclick='history.back()' {ifp 'shop.notice.add|shop.notice.edit'}style='margin-left:10px;'{/if} value="返回列表" class="btn btn-default" />
                    </div>
            </div>
 
    </form>
 

<script language='javascript'>
    function formcheck() {
        if ($("#title").isEmpty()) {
            Tip.focus("title", "请填写分类名称!");
            return false;
        }
        return true;
    }
</script>
{/if}
{template '_footer'}